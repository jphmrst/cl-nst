\section{Integration with ASDF}
NST provides an extension \texttt{asdf:nst-testable} of class
\texttt{asdf:system} to help automate testing.  Specify that a system
should be \texttt{nst-testable} with the \texttt{:class} argument to
\texttt{asdf:defsystem}, and provide one or more of the following
additional arguments:
\begin{itemize}
\item\texttt{:nst-systems ({\slshape system} {\slshape system}
    $\cdots$ {\slshape system})}\par Specifies a list of other systems
  which should be tested when testing this system.
\item\texttt{:nst-packages ({\slshape package} {\slshape package}
    $\cdots$ {\slshape package})}\par When the system is tested, all
  groups and tests in the named packages should be run.
\item\texttt{:nst-groups (({\slshape package} {\slshape group})
    $\cdots$ ({\slshape package} {\slshape group}))}\par When the
  system is tested, tests in the named groups should be run.  Naming
  the package separately from the group and test in this argument (and
  in the similar arguments below) allows the group to be named before
  its package is necessarily defined.
\item\texttt{:nst-tests (({\slshape package} {\slshape group}
    {\slshape test}) $\cdots$ ({\slshape package} {\slshape group}
    {\slshape test}))}\par When the system is tested, all the named
  tests should be run.
\end{itemize}
The next three arguments to an \texttt{nst-testable} system are
mutually exclusive, and moreover exclude any of the above arguments:
\begin{itemize}
\item\texttt{:nst-package {\slshape package}}\par When the system is
  tested, all groups and tests in the named package should be run.
\item\texttt{:nst-group ({\slshape package} {\slshape group})}\par
  When the system is tested, all tests in the named group should be
  run.
\item\texttt{:nst-test ({\slshape package} {\slshape group} {\slshape
      test})}\par When the system is tested, the given test should be
  run.
\end{itemize}
Another optional argument to an \texttt{nst-testable} system
definition is:
\begin{itemize}
\item\texttt{:nst-init ({\slshape arg-list ...\ arg-list})}\par
  Initializing arguments to NST, to be executed after this system is
  loaded.  Each \texttt{arg-list} is passed as the arguments as if to
  a call to the \texttt{nst-cmd} macro.
\end{itemize}
Figure~\ref{fig:asdf} gives examples of \texttt{nst-testable}
ASDF system definitions.
\begin{figure}
\begin{verbatim}
;; NST and its ASDF interface must be loaded
;; before we can process the defsystem form.
(asdf:oos 'asdf:load-op :asdf-nst)

(defsystem :mnst
    :class nst-testable
    :description "The NST test suite's self-test."
    :serial t
    :nst-systems (:masdfnst)
    :nst-groups ((:mnst-simple . g1)
                 (:mnst-simple . g1a)
                 (:mnst-simple . g1a1)
                 (:mnst-simple . core-checks))
    :depends-on (:nst)
    :in-order-to ((test-op (load-op :mnst)))
    :components ((:module "core"
                  :components ((:file "byhand")
                               (:file "builtin-checks")))))
\end{verbatim}
\caption{Definitions of \texttt{nst-testable} ASDF systems.}
\label{fig:asdf}
\end{figure}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "manual"
%%% End: 
